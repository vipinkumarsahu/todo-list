<div class="container" id="2" ondrop="drop(event)" ondragover="allowDrop(event)">
  <div class="row">
    <div class="col-md-4">
      <div class="todolist not-done">
        <h1>Todos</h1>
        <form method="post" action="/add-task" id="form1">
          <div class="panel-footer">
            <div class="input-group">
              <input id="btn-input" type="text" name="task" class="form-control input-sm" placeholder="Add todo..." />
              <span class="input-group-btn">
                <div class="input-group">
                  <button type="submit" form="form1" value="Submit" class="btn btn-success btn-sm">Add Task</button>
                </div>

              </span>
            </div>
          </div>
        </form>
        <hr>
        <div class="panel-body" id="0" ondrop="drop(event)" ondragover="allowDrop(event)">
          <% var count = 0; %>
            <table class="table table-striped tableWithSearch">
              <thead>
                <tr>
                  <th>TASK</th>
                  <th>STATUS</th>
                  <th>ACTION TO BE DONE</th>
                </tr>
              </thead>
              <tbody>
                <% for(let i = 0; i< tasks.length; i++) {
                if(tasks[i].taskstatus == 0){
                  count = count +1;
                %>
                  <tr class="gradeC check" draggable="true" ondragstart="drag(event)" id="<%= tasks[i].id %>/<%= tasks[i].taskstatus %>">
                    <td class="col-md-1" >
                      <%= tasks[i].task %>
                    </td>
                    <td class="col-md-1">
                      <%= tasks[i].taskstatus == 0 ? 'Open':tasks[i].taskstatus == 1 ?'In Progress':'Done' %>
                    </td>
                    <td class="center col-md-2">
                      <div class="btn-group">

                        <a href="/task-status/1/<%= tasks[i].id %>" class="btn btn-success" data-toggle="tooltip" data-original-title="In Progress">
                          <i class="fa fa-expand"></i>
                        </a>
                        <a href="javascript:;" data-act="delete-modal" data-parent-elm="tr" data-remove-parent="true" data-url="/delete-task" data-method="POST"
                          data-post-id="<%=tasks[i].id%>" class="btn btn-danger" data-toggle="tooltip" data-original-title="Delete">
                          <i class="fa fa-trash" aria-hidden="true"></i>
                        </a>
                      </div>
                    </td>
                  </tr>
                  <% }} %>
              </tbody>
            </table> 
        </div>
      </div>
      <div class="todo-footer">
        <strong>
          <span class="count-todos"></span>
        </strong> Items Left:
        <%= count %>
      </div>
    </div>
    <div class="col-md-4">
      <div class="todolist">
        <h1>In Progress</h1>
        <div class="panel-body" id="1" ondrop="drop(event)" ondragover="allowDrop(event)">
          <% var count1 = 0; %>
            <table class="table table-striped tableWithSearch">
              <thead>
                <tr>
                  <th>TASK</th>
                  <th>STATUS</th>
                  <th>ACTION TO BE DONE</th>
                </tr>
              </thead>
              <tbody>
                <% for(let i = 0; i< tasks.length; i++) {
                if(tasks[i].taskstatus == 1){
                  count1 = count1 + 1;
                %>
                  <tr class="gradeC" draggable="true" ondragstart="drag(event)" id="<%= tasks[i].id %>/<%= tasks[i].taskstatus %>">
                    <td class="col-md-1">
                      <%= tasks[i].task %>
                    </td>
                    <td class="col-md-1">
                      <%= tasks[i].taskstatus == 0 ? 'Open':tasks[i].taskstatus == 1 ?'In Progress':'Done' %>
                    </td>
                    <td class="center col-md-2">
                      <div class="btn-group">
                        <a href="/task-status/2/<%= tasks[i].id %>" class="btn btn-success" data-toggle="tooltip" data-original-title="Done">
                          <i class="fa fa-expand"></i>
                        </a>
                        <a href="javascript:;" data-act="delete-modal" data-parent-elm="tr" data-remove-parent="true" data-url="/delete-task" data-method="POST"
                          data-post-id="<%=tasks[i].id%>" class="btn btn-danger" data-toggle="tooltip" data-original-title="Delete">
                          <i class="fa fa-trash" aria-hidden="true"></i>
                        </a>
                      </div>
                    </td>
                  </tr>
                  <% }} %>
              </tbody>
            </table> 
        </div>
      </div>
      <div class="todo-footer">
        <strong>
          <span class="count-todos"></span>
        </strong> Items Left:
        <%= count1 %>
      </div>
    </div>
    <div class="col-md-4">
      <div class="todolist">
        <h1>Done</h1>
        <div class="panel-body" id="2" ondrop="drop(event)" ondragover="allowDrop(event)">
          <% var count2 = 0; %>
            <table class="table table-striped tableWithSearch">
              <thead>
                <tr>
                  <th>TASK</th>
                  <th>STATUS</th>
                  <th>ACTION TO BE DONE</th>
                </tr>
              </thead>
              <tbody>
                <% for(let i = 0; i< tasks.length; i++) {
                if(tasks[i].taskstatus == 2){
                  count2 = count2 + 1;
                %>
                  <tr class="gradeC" draggable="true" ondragstart="drag(event)" id="<%= tasks[i].id %>/<%= tasks[i].taskstatus %>">
                    <td class="col-md-1">
                      <%= tasks[i].task %>
                    </td>
                    <td class="col-md-1">
                      <%= tasks[i].taskstatus == 0 ? 'Open':tasks[i].taskstatus == 1 ?'In Progress':'Done' %>
                    </td>
                    <td class="center col-md-2">
                      <div class="btn-group">
                        <a href="javascript:;" data-act="delete-modal" data-parent-elm="tr" data-remove-parent="true" data-url="/delete-task" data-method="POST"
                          data-post-id="<%=tasks[i].id%>" class="btn btn-danger" data-toggle="tooltip" data-original-title="Delete">
                          <i class="fa fa-trash" aria-hidden="true"></i>
                        </a>
                      </div>
                    </td>
                  </tr>
                  <% } }%>
              </tbody>
            </table> 
        </div>
        <div class="todo-footer">
          <strong>
            <span class="count-todos"></span>
          </strong> Items Left:
          <%= count2 %>
        </div>
      </div>

    </div>
  </div>
</div>

<script>
  $(document).ready(function(){
    $('#btn-input').focus();
  });

  function allowDrop(ev) {
    ev.preventDefault();
    ev.dataTransfer.effectAllowed = "copy";

  }

  function drag(ev) {
    ev.dataTransfer.setData("text", ev.target.id);
    ev.dataTransfer.dropEffect = "copy"
  }

  function drop(ev) {
    ev.preventDefault();
    debugger;
    var data = ev.dataTransfer.getData("text");
    ev.target.appendChild(document.getElementById(data));
    var status = ev.target.id;
    var data1 ={
      id : data,
      dropStatus: status
    }
    
    $.ajax({
      type: 'POST',
      data:  JSON.stringify(data1),
      contentType: 'application/json',
      url: '/endpoint',
      success: function (data) {
        console.log('success');
        console.log(JSON.stringify(data));
        location.reload();
      },
      error: function () { console.log('error') }
    });
  }

  //Ajax request

  $(function () {
    $('.check').click(function (e) {
      e.preventDefault();
      debugger
      console.log('select_link clicked');
 
     /*  $.ajax({
         dataType: 'jsonp',
         data: data,						
         jsonp: 'callback',
         url: '/endpoint1/8?callback=?',						
         success: function(data) {
             console.log('success');
             console.log(JSON.stringify(data));
         }
     }); */
    /*   var data = {};
     
      data.title = "title";
      data.message = "message";

      $.ajax({
        type: 'POST',
        data: JSON.stringify(data),
        contentType: 'application/json',
        url: '/endpoint',
        success: function (data) {
          console.log('success');
          console.log(JSON.stringify(data));
        },
        error: function () { console.log('error') }
      }); */
    /*   var data = {};
     
      data.title = "title";
      data.message = "message";
      $.ajax('/endpoint1/6', {
              type: 'POST',
              data: JSON.stringify(data),
              contentType: 'application/json',
              success: function() { console.log('success');},
              error  : function() { console.log('error');}
      }); */
    });
  });
</script>


<style>
   
  tr {
    display: block;
  }
</style>